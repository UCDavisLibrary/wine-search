<!--
`<wine-search-pagination>` is Description

@element wine-search-pagination
-->
<dom-module id="wine-search-pagination">
  <template>
    <style include="shared-styles"></style>
    <style>
      :host {
        display: block
      }
    </style>

    <div style="display:flex; align-items: center">
      <paper-icon-button 
        icon="arrow-back" 
        disabled$="[[!backEnabled]]"
        on-click="back">
      </paper-icon-button>
      <div style="flex:1; text-align:center">
        <slot></slot>
      </div>
      <paper-icon-button 
        icon="arrow-forward" 
        disabled$="[[!forwardEnabled]]"
        on-click="forward">
      </paper-icon-button>
    </div>
    
  </template>

  <script>
    class WineSearchPagination extends 
        Mixin(Polymer.Element)
        .with(EventMixin, SearchMixin) {

      static get is() { return 'wine-search-pagination'; }

      static get properties() {
        return {
          backEnabled : {
            type : Boolean,
            value : false
          },
          forwardEnabled : {
            type : Boolean,
            value : false
          },
          start : {
            type : Number,
            value : 0
          },
          itemsPerPage : {
            type : Number,
            value : 0
          }
        }
      }

      ready() {
        super.ready();
        this._getDefaultSearch().then((e) => this._onSearchUpdate(e));
      }

      _onDefaultSearchUpdate(e) {
        this._onSearchUpdate(e);
      }

      _onSearchUpdate(e) {
        if( e.state !== 'loaded' ) return;

        this.start = e.request.from;
        this.itemsPerPage = e.request.size;
        
        var total = e.payload.hits.total;

        this.backEnabled = (this.start === 0) ? false : true;
        this.forwardEnabled = (this.start + this.itemsPerPage < total ) ? true : false;
      }

      back() {
        var from = this.start - this.itemsPerPage;
        if( from < 0 ) from = 0;

        this._setSearchPaging(from);
      }

      forward() {
        var from = this.start + this.itemsPerPage;
        this._setSearchPaging(from);
      }

    }

    window.customElements.define(WineSearchPagination.is, WineSearchPagination);
  </script>
</dom-module>